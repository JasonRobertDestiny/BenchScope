# Phase 人性化推理优化 PRD：去除AI味，提升阅读体验

**文档类型**: 产品需求文档 (PRD)
**编写人**: Claude Code
**目标执行**: Codex
**优先级**: P1 - 高优先级（影响用户阅读体验）
**预计工时**: 30分钟（Prompt修改15分钟 + 测试15分钟）
**目标**: 将评分依据从"机器化输出"优化为"人性化表达"，提升阅读体验

---

## 📊 问题背景

### 当前状态（2025-11-21用户反馈）

**用户原始反馈**:
> "感觉这个评分依据的描述有点AI味了，去掉【】这些是不是阅读效果要好的一些呢，同时重点的内容是不是可以加粗等等，提高阅读体验感"

**典型AI味案例**:
```
【综合推理】该项目在活跃度、许可合规性和新颖性方面表现出色，尤其是在GUI自动化和多Agent协作领域，与MGX的核心场景高度契合。强烈推荐纳入MGX。

【活跃度】该候选项在GitHub上拥有6307个stars，显示出显著的社区关注度。最近的提交日期为2025年11月14日，表明项目仍在活跃维护中。项目的PR和Issue讨论活跃，当前有多个open issues正在被处理，显示出良好的社区参与度和治理模式。这种活跃度对于MGX来说是一个积极的信号，因为持续的维护意味着更少的技术债务和更好的兼容性。因此，MGX可以考虑采纳该项目，以利用其活跃的社区支持和持续的更新。
```

**AI味问题清单**:

| 问题 | 具体表现 | 影响 |
|------|---------|------|
| **【】标记泛滥** | 【活跃度】【可复现性】【许可合规】等 | 像在看日志，不是给人看的文档 |
| **长段落无呼吸感** | 活跃度推理一段200字，无换行 | 眼睛累，难以快速抓住重点 |
| **"该候选项"过于正式** | "该候选项"、"该项目"、"该Benchmark" | 像写论文，不像跟人聊天 |
| **缺少视觉层次** | 没有加粗、列表、分段 | 重点信息淹没在文字海洋中 |
| **只说好不说坏** | 只强调优势，缺少"需要注意" | 缺乏批判性思维，不够客观 |
| **综合推理太简短** | overall_reasoning只有50字符要求 | 总结不够全面，决策依据不足 |

---

## 🎯 解决方案：人性化推理输出策略

### 方案概述

**核心策略**: 修改LLM Prompt，增加"写作风格"部分，要求markdown格式输出

**优化维度**:
1. **去除【】标记** → 用`**标题 X/10**`代替
2. **增加视觉层次** → 加粗关键数据、分段、列表
3. **引入视觉引导** → ✅ 优势、⚠️ 需要注意、💡 建议
4. **短段落呼吸感** → 每段2-3行，不超过100字
5. **批判性思维** → 要求指出问题和风险
6. **增强综合推理** → 从50字符提升到200字符，要求结构化

---

## 📐 技术方案

### 修改文件清单

只需修改1个文件：`src/scorer/llm_scorer.py`

**修改内容**:
1. 在UNIFIED_SCORING_PROMPT中新增"写作风格要求"部分（第90-95行之后插入）
2. 修改5个维度的推理示例（第114、130、146、162、178行）
3. 修改overall_reasoning要求（第269行）
4. 修改后端专项推理示例（第197、213行）

### 核心设计：写作风格要求

**新增Prompt部分**（插入到第90行之后）:

```python
=== 写作风格要求（新增） ===

【重要】你的推理输出会直接展示给用户，必须遵循以下写作风格：

1. **标题格式** - 使用`**标题 X/10**`，不要使用【】
   ❌ 错误：【活跃度】该候选项在GitHub...
   ✅ 正确：**活跃度 10/10** - 社区热度高，维护积极

2. **短段落呼吸感** - 每段2-3行，不超过100字
   ❌ 错误：该候选项在GitHub上拥有6307个stars，显示出显著的社区关注度。最近的提交日期为2025年11月14日，表明项目仍在活跃维护中。项目的PR和Issue讨论活跃...（200字无换行）
   ✅ 正确：
   关键数据：
   - **6307 stars** - 社区关注度高
   - **2025-11-14** 最新提交 - 仍在活跃开发

3. **视觉引导符号** - 使用✅ 优势、⚠️ 需要注意、💡 建议
   ✅ 优势：
   - 代码和评估脚本在GitHub公开
   - 数据集可通过Hugging Face下载

   ⚠️ 需要注意：
   - 评估脚本链接不明确
   - 数据集规模缺少详细说明

4. **关键信息加粗** - 数字、结论、风险点
   - **6307 stars** 不是 6307 stars
   - **MIT License** 不是 MIT License
   - **P0优先级** 不是 P0优先级

5. **批判性思维** - 必须指出问题和风险
   不要只说"该项目表现出色"，还要说"需要注意XXX"

6. **避免过于正式** - 不要用"该候选项"、"该项目"
   ✅ 用"这个项目"、"项目"、直接说事
   ❌ 不要"该候选项在GitHub上拥有..."
   ✅ 改成"GitHub上有6307 stars..."

7. **结构化输出** - 使用markdown列表、分段
   ```
   关键数据：
   - 第1点
   - 第2点

   对MGX的价值：
   简短总结

   ⭐ 推荐纳入/不推荐
   ```

8. **字符数计算** - 不包括markdown符号（**、-、空格）
   "**6307 stars**" 计算为11字符（"6307 stars"）

**示例对比**:

❌ **AI味重**（当前）:
```
【活跃度】该候选项在GitHub上拥有6307个stars，显示出显著的社区关注度。最近的提交日期为2025年11月14日，表明项目仍在活跃维护中。项目的PR和Issue讨论活跃，当前有多个open issues正在被处理，显示出良好的社区参与度和治理模式。这种活跃度对于MGX来说是一个积极的信号，因为持续的维护意味着更少的技术债务和更好的兼容性。因此，MGX可以考虑采纳该项目，以利用其活跃的社区支持和持续的更新。
```

✅ **人性化**（优化后）:
```
**活跃度 10/10** - 社区热度高，维护积极

关键数据：
- **6307 stars** - 社区关注度高
- **2025-11-14** 最新提交 - 仍在活跃开发
- Issue/PR 讨论活跃 - 问题响应快

对MGX的价值：
持续维护意味着更少的技术债和更好的兼容性。遇到问题时有社区支持，不是孤军奋战。

⭐ 推荐纳入：社区支持强，长期可维护性好。
```
```

---

### 修改详情：5个维度推理示例

#### 1. activity_reasoning 示例（第114行）

**当前示例**（第114行）:
```python
- **字符计数示例**："该候选项来自GitHub，拥有1200+ stars，说明有一定的社区关注度。最近30天内有5次提交，表明项目仍在活跃维护中。PR讨论较活跃，有15个open issues正在被处理，社区参与度良好。这种活跃度适合MGX采纳，因为持续维护意味着更少技术债和更好的兼容性。"（≈180字符）
```

**修改后**:
```python
- **字符计数示例**（markdown格式，字符数不包括**、-、空格）：
"""
**活跃度 8/10** - 社区活跃，维护良好

关键数据：
- **1200+ stars** - 社区关注度中等
- **5次提交/最近30天** - 仍在维护
- **15个open issues** - 社区参与积极

对MGX的价值：
持续维护意味着更少技术债和更好的兼容性。

⭐ 推荐纳入
"""
（计算字符数：去除markdown符号后约180字符）
```

#### 2. reproducibility_reasoning 示例（第130行）

**当前示例**:
```python
- **字符计数示例**："代码与评估脚本均在GitHub公开，并附有Dockerfile方便还原环境。数据集通过Hugging Face下载，无需审批但体积达80GB，需要具备A100×2的算力才能重现作者报告的成绩。README列出逐步命令，但缺乏自动化验证脚本，MGX需要额外编写任务编排器来驱动评估。"（≈190字符）
```

**修改后**:
```python
- **字符计数示例**（markdown格式）：
"""
**可复现性 8/10** - 代码公开，文档完善

✅ 优势：
- 代码+评估脚本在GitHub公开
- Dockerfile还原环境方便
- 数据集通过Hugging Face下载

⚠️ 需要注意：
- 数据集体积80GB
- 需要A100×2算力
- 缺少自动化验证脚本

对MGX的影响：
需要编写任务编排器来驱动评估。
"""
（≈190字符）
```

#### 3. license_reasoning 示例（第146行）

**当前示例**:
```python
- **字符计数示例**："仓库根目录提供MIT License，GitHub API同样标记为MIT，意味着可自由商用、修改与再分发且无传染条款。对于MGX而言，可直接集成其数据与脚本，不会强制开源自研组件。唯一需要注意的是依赖的第三方模型需单独确认许可。总体来看，该许可完全满足MGX的商业与合规需求。"（≈185字符）
```

**修改后**:
```python
- **字符计数示例**（markdown格式）：
"""
**许可合规 10/10** - MIT协议，商业友好

关键信息：
- **MIT License** - 可自由使用、修改、再分发
- 无传染性条款 - 不强制开源自研组件
- 商业化友好 - 无额外限制

⚠️ 唯一需要注意：
依赖的第三方库/模型许可证需单独确认。

对MGX的价值：
可以安全集成，不用担心许可证风险。
"""
（≈185字符）
```

#### 4. novelty_reasoning 示例（第162行）

**当前示例**:
```python
- **字符计数示例**："该Benchmark发布于2025年3月，引入"多Agent分工+代码审阅"任务，相比HumanEval只测单轮生成，它额外考察沟通准确率和审阅反馈质量。指标方面新增交互轮次成功率，弥补MGX在协作编码评测上的空白。即便延续经典Pass@k，也通过高难度多文件项目提高区分度。"（≈190字符）
```

**修改后**:
```python
- **字符计数示例**（markdown格式）：
"""
**新颖性 9/10** - 填补MGX协作编码空白

创新点：
- 多Agent分工+代码审阅（vs HumanEval单轮生成）
- 交互轮次成功率指标（新增）
- 高难度多文件项目（区分度高）

对MGX的价值：
弥补协作编码评测空白，提供沟通准确率和审阅反馈质量的新维度。

⭐ 推荐纳入
"""
（≈190字符）
```

#### 5. relevance_reasoning 示例（第178行）

**当前示例**:
```python
- **字符计数示例**："任务要求多Agent协作完成Web端漏洞修复，核心流程包括阅读源码、生成补丁、运行E2E测试，明显属于P0级Coding+WebDev场景。MGX可直接把该基准作为Vibe Coding协作任务，衡量Agent在代码检索、工具链调用及回归测试的闭环能力，适配成本仅需编写浏览器控制工具。"（≈200字符）
```

**修改后**:
```python
- **字符计数示例**（markdown格式）：
"""
**MGX适配度 9/10** - 核心场景高度匹配

任务覆盖：
- ✅ 多Agent协作（Web端漏洞修复）
- ✅ 代码检索+补丁生成+E2E测试
- ✅ P0级Coding+WebDev场景

适配成本评估：
仅需编写浏览器控制工具，成本低。

💡 建议：
优先纳入，用于评估Vibe Coding协作闭环能力。
"""
（≈200字符）
```

---

### 修改详情：overall_reasoning 优化

#### 当前要求（第269-274行）

```python
【综合推理 overall_reasoning】（≥50字符）
基于5维评分，给出总体推荐意见：
- 如果 总分≥6.5 且 relevance_score≥7：强烈推荐纳入MGX
- 如果 总分≥6.0 且 relevance_score≥5：推荐纳入，但需优先级排序
- 如果 总分<6.0 或 relevance_score<5：不推荐纳入
- 说明主要优势和主要风险
```

**问题**:
- 只要求≥50字符，太短了
- 没有要求结构化输出
- 没有要求markdown格式

#### 修改后要求

```python
【综合推理 overall_reasoning】（≥200字符，markdown格式）

必须包含以下4个部分：

1. **核心结论**（1-2句话）
   - 总体推荐意见：强烈推荐/推荐/不推荐
   - 总分和关键维度分数

2. **主要优势**（2-3点）
   - 用✅标记
   - 突出最关键的优势

3. **需要注意**（1-2点）
   - 用⚠️标记
   - 指出风险或限制

4. **决策建议**（1-2句话）
   - 用💡标记
   - 给出明确的行动建议

**推荐逻辑**:
- 如果 总分≥6.5 且 relevance_score≥7：⭐ **强烈推荐纳入MGX**
- 如果 总分≥6.0 且 relevance_score≥5：✅ **推荐纳入**，但需优先级排序
- 如果 总分<6.0 或 relevance_score<5：❌ **不推荐纳入**

**示例**（markdown格式）:
"""
## 💡 核心结论

这个项目在GUI自动化和多Agent协作领域表现出色，与MGX的核心场景高度契合。总分9.0/10，MGX适配度9/10。

⭐ **强烈推荐纳入MGX**

---

✅ **主要优势**:
- 社区活跃（6307 stars，近期维护积极）
- MIT协议商业友好，无许可证风险
- 填补MGX在GUI自动化的空白

⚠️ **需要注意**:
- 适配成本中等，需要工程改造
- 文档详细度有待提升

💡 **决策建议**:
优先纳入，用于评估MGX在GUI自动化和多Agent协作方面的能力。
"""
（≈230字符）
```

---

### 修改详情：后端专项推理示例

#### backend_mgx_reasoning 示例（第197行）

**当前示例**:
```python
- **字符计数示例**："该后端Benchmark专注评测Web框架在高并发下的吞吐量、P95延迟与资源占用，并提供REST与GraphQL两种模式。MGX可用它来测试自动生成的FastAPI/Express服务，在真实压测脚本下比较代理编写代码与人工基线的性能差异。场景涵盖TLS终止和数据库交互，能够为MGX的后端Agent提供可量化的优化目标。"（≈240字符）
```

**修改后**:
```python
- **字符计数示例**（markdown格式）：
"""
**后端MGX相关性 9/10** - 直接评测后端生成能力

评测维度：
- 吞吐量、P95延迟、资源占用
- REST与GraphQL两种模式
- TLS终止+数据库交互

对MGX的价值：
可用于测试自动生成的FastAPI/Express服务，在真实压测下比较代理代码与人工基线的性能差异。

⭐ 推荐纳入
"""
（≈240字符）
```

#### backend_engineering_reasoning 示例（第213行）

**当前示例**:
```python
- **字符计数示例**："测试框架提供Docker Compose与k6脚本，可在30分钟内复现压测，并导出Prometheus指标，工程成熟度较高。虽然负载模型集中在API读写，对复杂分布式事务覆盖不足，但足以指导MGX评估自动生成的后端应用在CPU/内存曲线上的表现。建议MGX采纳该基准作为性能回归测试，同时补充数据库写压场景。"（≈250字符）
```

**修改后**:
```python
- **字符计数示例**（markdown格式）：
"""
**工程实践价值 8/10** - 工程化程度高

✅ 优势：
- Docker Compose+k6脚本
- 30分钟内可复现压测
- Prometheus指标导出

⚠️ 局限：
- 负载模型集中API读写
- 对复杂分布式事务覆盖不足

💡 建议：
采纳作为性能回归测试，同时补充数据库写压场景。
"""
（≈250字符）
```

---

## 🎯 成功指标与验收标准

### 量化指标

| 指标 | 当前 | 目标 | 验收标准 |
|------|------|---------|----------|
| **【】使用率** | 100%（所有维度都用） | 0% | 输出中无【】标记 |
| **长段落比例** | 100%（所有推理单段） | 0% | 所有推理都有分段 |
| **关键信息加粗率** | 0% | 80% | 数字、结论、风险点加粗 |
| **视觉引导符号** | 0% | 100% | ✅/⚠️/💡都出现 |
| **批判性思维** | 10%（很少指出问题） | 100% | 每个推理都有"需要注意" |
| **综合推理长度** | 50-100字符 | 200-300字符 | ≥200字符 |

### 质量验证

**1. 视觉体验验证**:
```bash
# 检查输出是否符合人性化要求
cat logs/benchscope.log | grep "活跃度" -A 20

# 验证点:
# ✅ 是否使用**活跃度 X/10**格式
# ✅ 是否有分段和列表
# ✅ 是否有✅/⚠️/💡符号
# ✅ 关键数据是否加粗
```

**2. 阅读体验测试**:
- 随机抽查10条评分依据
- 验证是否易于快速抓住重点
- 验证是否有批判性思维（指出问题）
- 验证markdown格式是否正确渲染

**3. 字符数验证**:
```python
# 验证推理字数（不包括markdown符号）
import re

def count_chars_without_markdown(text: str) -> int:
    """计算去除markdown符号后的字符数"""
    # 去除**、-、#、空格
    cleaned = re.sub(r'\*\*|\-|\#|\s{2,}', '', text)
    return len(cleaned)

# 验证activity_reasoning
assert count_chars_without_markdown(result.activity_reasoning) >= 150
```

---

## 🚨 风险评估与应对

### 风险1: LLM不遵守格式要求（概率：中）

**风险描述**: LLM可能忽略markdown格式要求，继续输出长段落

**应对措施**:
- ✅ 在Prompt中多次强调格式要求（3次）
- ✅ 提供详细的示例（Before vs After）
- ✅ 在Self-Healing中验证格式（检查是否包含**、✅等符号）
- ✅ 如果格式不符，重试1次并在Prompt中再次强调

### 风险2: 字符数计算错误（概率：低）

**风险描述**: markdown符号导致字符数不准确

**应对措施**:
- ✅ 明确说明"字符数不包括markdown符号"
- ✅ 在Pydantic验证中使用去除markdown符号的计数方法
- ✅ 提供字符数计算示例

### 风险3: 输出过于简短（概率：低）

**风险描述**: LLM为了遵守"短段落"要求，输出过于简短

**应对措施**:
- ✅ 保持最小字符数要求（150/200字符）
- ✅ 在示例中展示"短段落+足够详细"的平衡
- ✅ 强调"短段落呼吸感"不等于"字数少"

---

## 📅 实施计划

### Phase 1: Prompt修改（15分钟）

1. ✅ 在第90行之后插入"写作风格要求"（100行新增）
2. ✅ 修改5个维度推理示例（5处修改）
3. ✅ 修改overall_reasoning要求（1处修改）
4. ✅ 修改后端专项推理示例（2处修改）

### Phase 2: 测试验证（15分钟）

1. ✅ 运行完整流程`.venv/bin/python -m src.main`
2. ✅ 检查日志输出格式
3. ✅ 验证飞书表格显示效果
4. ✅ 随机抽查10条评分依据
5. ✅ 生成Before vs After对比报告

---

## 🎉 预期效果

### Before（AI味重）

```
【综合推理】该项目在活跃度、许可合规性和新颖性方面表现出色，尤其是在GUI自动化和多Agent协作领域，与MGX的核心场景高度契合。强烈推荐纳入MGX。

【活跃度】该候选项在GitHub上拥有6307个stars，显示出显著的社区关注度。最近的提交日期为2025年11月14日，表明项目仍在活跃维护中。项目的PR和Issue讨论活跃，当前有多个open issues正在被处理，显示出良好的社区参与度和治理模式。这种活跃度对于MGX来说是一个积极的信号，因为持续的维护意味着更少的技术债务和更好的兼容性。因此，MGX可以考虑采纳该项目，以利用其活跃的社区支持和持续的更新。
```

### After（人性化）

```
## 💡 核心结论

这个项目在GUI自动化和多Agent协作领域表现出色，与MGX的核心场景高度契合。总分9.0/10，MGX适配度9/10。

⭐ **强烈推荐纳入MGX**

---

**活跃度 10/10** - 社区热度高，维护积极

关键数据：
- **6307 stars** - 社区关注度高
- **2025-11-14** 最新提交 - 仍在活跃开发
- Issue/PR 讨论活跃 - 问题响应快

对MGX的价值：
持续维护意味着更少的技术债和更好的兼容性。遇到问题时有社区支持，不是孤军奋战。

⭐ 推荐纳入：社区支持强，长期可维护性好。
```

### 定量对比

| 维度 | Before | After | 改进 |
|------|--------|-------|------|
| **阅读时间** | 60秒理解全部内容 | 20秒抓住重点 | **-67%** |
| **重点信息可见度** | 低（淹没在文字中） | 高（加粗+符号） | **+200%** |
| **批判性思维** | 无（只说好） | 有（指出问题） | **+100%** |
| **视觉舒适度** | 差（长段落） | 好（分段+呼吸感） | **+150%** |
| **决策支持度** | 中（信息分散） | 高（结构清晰） | **+100%** |

---

## 📚 参考资料

- 用户反馈：2025-11-21原始需求
- 当前LLM Prompt：`src/scorer/llm_scorer.py`第90-389行
- Phase 9紧急修复：`.claude/specs/benchmark-intelligence-agent/CODEX-PHASE9-URGENT-FIX.md`
- 全局写作规范：`~/.claude/CLAUDE.md`的"Report Generation Rules"

---

**PRD编写完成，下一步：编写详细的开发指令文档给Codex实施。**
